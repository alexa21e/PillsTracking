import{Ya as h,_a as m,f as s,g as c,gb as U,h as u,j as o,jb as p,n as a,p as l}from"./chunk-ZHHVF4N4.js";var R=(()=>{let r=class r{constructor(t,e){this.http=t,this.router=e,this.baseUrl=p.baseUrl+"api/account/",this.currentUserSource=new c(1),this.currentUser$=this.currentUserSource.asObservable(),this.currentUserRoleSource=new s(null),this.currentUserRole$=this.currentUserRoleSource.asObservable(),this.currentUserEmailSource=new s(null),this.currentUserEmail$=this.currentUserEmailSource.asObservable()}loadCurrentUser(t){if(t===null)return this.currentUserSource.next(null),u(null);let e=new h;return e=e.set("Authorization",`Bearer ${t}`),this.http.get(this.baseUrl,{headers:e}).pipe(o(i=>i?(this.currentUserSource.next(i),this.currentUserRoleSource.next(i.role),this.currentUserEmailSource.next(i.email),i):null))}getCurrentUser(){return this.http.get(this.baseUrl)}login(t){return this.http.post(this.baseUrl+"login",t).pipe(o(e=>(localStorage.setItem("token",e.token),this.currentUserSource.next(e),this.currentUserRoleSource.next(e.role),this.currentUserEmailSource.next(e.email),e)))}registerAdmin(t){return this.http.post(this.baseUrl+"register/admin",t).pipe(o(e=>(localStorage.setItem("token",e.token),this.currentUserSource.next(e),this.currentUserRoleSource.next(e.role),this.currentUserEmailSource.next(e.email),e)))}registerDoctor(t){return this.http.post(this.baseUrl+"register/doctor",t).pipe(o(e=>(localStorage.setItem("token",e.token),this.currentUserSource.next(e),this.currentUserRoleSource.next(e.role),this.currentUserEmailSource.next(e.email),e)))}logout(){localStorage.removeItem("token"),this.currentUserSource.next(null),this.currentUserRoleSource.next(null),this.currentUserEmailSource.next(null),this.router.navigateByUrl("/")}redirectBasedOnRole(t){t.role==="Admin"?this.router.navigate(["/admin"]):t.role==="Doctor"&&this.router.navigate(["/doctor"])}};r.\u0275fac=function(e){return new(e||r)(l(m),l(U))},r.\u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();export{R as a};
